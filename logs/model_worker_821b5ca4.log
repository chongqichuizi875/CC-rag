2023-11-12 14:39:50 | INFO | model_worker | Loading the model ['chatglm2-6b'] on worker 821b5ca4 ...
2023-11-12 14:40:40 | ERROR | stderr | Loading checkpoint shards:   0%|                                                                                                 | 0/7 [00:00<?, ?it/s]
2023-11-12 14:40:43 | ERROR | stderr | Loading checkpoint shards:   0%|                                                                                                 | 0/7 [00:03<?, ?it/s]
2023-11-12 14:40:43 | ERROR | stderr | 
2023-11-12 14:40:43 | ERROR | stderr | Process model_worker - chatglm2-6b:
2023-11-12 14:40:43 | ERROR | stderr | Traceback (most recent call last):
2023-11-12 14:40:43 | ERROR | stderr |   File "/usr/local/anaconda3/envs/lc/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
2023-11-12 14:40:43 | ERROR | stderr |     self.run()
2023-11-12 14:40:43 | ERROR | stderr |   File "/usr/local/anaconda3/envs/lc/lib/python3.10/multiprocessing/process.py", line 108, in run
2023-11-12 14:40:43 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2023-11-12 14:40:43 | ERROR | stderr |   File "/home/cc007/cc/Langchain-Chatchat/startup.py", line 382, in run_model_worker
2023-11-12 14:40:43 | ERROR | stderr |     app = create_model_worker_app(log_level=log_level, **kwargs)
2023-11-12 14:40:43 | ERROR | stderr |   File "/home/cc007/cc/Langchain-Chatchat/startup.py", line 210, in create_model_worker_app
2023-11-12 14:40:43 | ERROR | stderr |     worker = ModelWorker(
2023-11-12 14:40:43 | ERROR | stderr |   File "/usr/local/anaconda3/envs/lc/lib/python3.10/site-packages/fastchat/serve/model_worker.py", line 74, in __init__
2023-11-12 14:40:43 | ERROR | stderr |     self.model, self.tokenizer = load_model(
2023-11-12 14:40:43 | ERROR | stderr |   File "/usr/local/anaconda3/envs/lc/lib/python3.10/site-packages/fastchat/model/model_adapter.py", line 306, in load_model
2023-11-12 14:40:43 | ERROR | stderr |     model, tokenizer = adapter.load_model(model_path, kwargs)
2023-11-12 14:40:43 | ERROR | stderr |   File "/usr/local/anaconda3/envs/lc/lib/python3.10/site-packages/fastchat/model/model_adapter.py", line 733, in load_model
2023-11-12 14:40:43 | ERROR | stderr |     model = AutoModel.from_pretrained(
2023-11-12 14:40:43 | ERROR | stderr |   File "/usr/local/anaconda3/envs/lc/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 561, in from_pretrained
2023-11-12 14:40:43 | ERROR | stderr |     return model_class.from_pretrained(
2023-11-12 14:40:43 | ERROR | stderr |   File "/usr/local/anaconda3/envs/lc/lib/python3.10/site-packages/transformers/modeling_utils.py", line 3480, in from_pretrained
2023-11-12 14:40:43 | ERROR | stderr |     ) = cls._load_pretrained_model(
2023-11-12 14:40:43 | ERROR | stderr |   File "/usr/local/anaconda3/envs/lc/lib/python3.10/site-packages/transformers/modeling_utils.py", line 3870, in _load_pretrained_model
2023-11-12 14:40:43 | ERROR | stderr |     new_error_msgs, offload_index, state_dict_index = _load_state_dict_into_meta_model(
2023-11-12 14:40:43 | ERROR | stderr |   File "/usr/local/anaconda3/envs/lc/lib/python3.10/site-packages/transformers/modeling_utils.py", line 743, in _load_state_dict_into_meta_model
2023-11-12 14:40:43 | ERROR | stderr |     set_module_tensor_to_device(model, param_name, param_device, **set_module_kwargs)
2023-11-12 14:40:43 | ERROR | stderr |   File "/usr/local/anaconda3/envs/lc/lib/python3.10/site-packages/accelerate/utils/modeling.py", line 317, in set_module_tensor_to_device
2023-11-12 14:40:43 | ERROR | stderr |     new_value = value.to(device)
2023-11-12 14:40:43 | ERROR | stderr | RuntimeError: CUDA error: out of memory
2023-11-12 14:40:43 | ERROR | stderr | CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
2023-11-12 14:40:43 | ERROR | stderr | For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
2023-11-12 14:40:43 | ERROR | stderr | Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
2023-11-12 14:40:43 | ERROR | stderr | 
